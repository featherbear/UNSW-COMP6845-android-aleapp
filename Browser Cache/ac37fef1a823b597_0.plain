/*! @name @brightcove/videojs-ssai @version 1.4.3 @license UNLICENSED */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@brightcove/loscore"),require("video.js"),require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["@brightcove/loscore","video.js","global/window","global/document"],t):e.videojsSsai=t(e.videojs.bc_,e.videojs,e.window,e.document)}(this,function(e,t,n,i){"use strict";function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n,i=i&&i.hasOwnProperty("default")?i.default:i;var o=e.qs();function s(e,t,n){void 0===n&&(n=Object.keys(t)),n.forEach(function(n){e[n+"_"]=t[n]})}function d(e,t){return e?Array.prototype.map.call(e,t).filter(Boolean):[]}function l(e){return e&&e.textContent&&e.textContent.trim()||""}function u(e,t){return e&&"object"==typeof e&&t&&t.length?u(e[t[0]],t.slice(1)):e}function c(e){if(e){var t=e.split("+")[0].split(":"),n=t[0],i=t[1],r=t[2];if(n&&i&&r)return 3600*Number(n)+60*Number(i)+Number(r)}return 0}function h(e){return void 0===e&&(e=""),"vjs-ssai"+(e?"-"+e:"")}function p(t,n){var i=t.split("?"),r=o.parse(i[1]||""),a=e.assign({},r,n);return i[0]+"?"+o.stringify(a)}var f=t.getComponent("Component"),g=t.dom,m=function(e){function n(t,n){var i;return(i=e.call(this,t,n)||this).on(i.learnMoreEl,"click",i.handleClick),i}r(n,e);var i=n.prototype;return i.createEl=function(){return this.adsRemainingEl=g.createEl("div",{className:h("ads-remaining")}),this.learnMoreEl=g.createEl("a",{className:[h("learn-more"),"vjs-hidden"].join(" "),href:"#"},{target:"_blank"},this.localize("Learn More")),g.createEl("div",{className:[h("overlay"),h("overlay-countdown"),"vjs-hidden"].join(" ")},{},[this.adsRemainingEl,this.learnMoreEl])},i.update=function(e){for(var n=e.linearAd,i=e.linearAdRoll,r=n.clickThroughUrl(),a=i.indexOf(n),o=this.lastLinearAdIndex_!==a,s=i.duration(),d=this.player().currentTime(),l=a;l--;){d+=i.get(l).duration()}var u,c=Math.floor(s)-Math.floor(d),h=t.formatTime(c,Math.floor(s));(0===c&&(h.replace(/00$/,"01"),h="< "+h),o||this.lastTimeRemaining_!==c)&&(u=i.length()>1?this.localize("Ad {1} of {2}: {3}",[i.indexOf(n)+1,i.length(),h]):this.localize("Ad: {1}",[h]),g.textContent(this.adsRemainingEl,u),r?(this.learnMoreEl.href=r,g.removeClass(this.learnMoreEl,"vjs-hidden")):g.addClass(this.learnMoreEl,"vjs-hidden"));this.lastLinearAdIndex_=a,this.lastTimeRemaining_=c},i.handleClick=function(e){var t=this.player_.ssai().currentLinearAd();e.preventDefault(),this.player_.trigger({type:"bcov-ssai-click-through",linearAd:t})},n}(f),v=t.getComponent("ClickableComponent"),y=t.dom,_=function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).nonIconControl=!0,i.el_.removeChild(i.controlTextEl_),i}r(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:[h("overlay"),h("overlay-skip-ad"),"vjs-hidden"].join(" "),innerHTML:""});return this.skipAdEl_=y.createEl("div",{className:[h("skip-ad-btn"),"vjs-hidden"].join(" ")},{},this.localize("Skip Ad")),y.appendContent(t,this.skipAdEl_),t},n.update=function(e){var t=e.linearAd.skipOffset();-1===t?y.addClass(this.skipAdEl_,"vjs-hidden"):t-e.relativeTime<=0?y.removeClass(this.skipAdEl_,"vjs-hidden"):y.hasClass(this.skipAdEl_,"vjs-hidden")||y.addClass(this.skipAdEl_,"vjs-hidden")},n.handleClick=function(e){var t=this.player_.ssai(),n=t.currentTimelineState();n.linearAdRoll&&(t.seekInAbsoluteTime(n.linearAd.absoluteEndTime()),t.log_("ad skipped"))},t}(v),A=t.getComponent("Component"),b=t.dom,k=function(e){function n(t,n){return e.call(this,t,n)||this}r(n,e);var i=n.prototype;return i.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:[h("overlay"),h("skip-ad-countdown-overlay"),"vjs-hidden"].join(" "),innerHTML:""});return this.skipAdCountdownEl_=b.createEl("div",{className:[h("skip-ad-overlay-content"),"vjs-hidden"].join(" ")},{},""),b.appendContent(t,this.skipAdCountdownEl_),t},i.update=function(e){if(e.linearAd){var n,i=e.linearAd.skipOffset(),r=this.player().currentTime(),a=i-Math.floor(r);this.lastSkipTimeRemaining_!==a&&(r>=i?b.addClass(this.skipAdCountdownEl_,"vjs-hidden"):(n=t.formatTime(a,Math.floor(e.linearAdRoll.duration_)),0===a&&(n.replace(/00$/,"01"),n="< "+n),b.removeClass(this.skipAdCountdownEl_,"vjs-hidden"),b.textContent(this.skipAdCountdownEl_,this.localize("You can skip ad in {1}",[n])))),this.lastSkipTimeRemaining_=a}},n}(A),T=function(){function t(e,t){this.player_=e,this.enabled_=!1,this.isNoOp_=!!t}var n=t.prototype;return n.delegate=function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.enabled_&&this.overlays_.forEach(function(n){e.isFn(n[t])&&n[t].apply(n,i)})},n.enable=function(){var e=this;if(!this.enabled_&&!this.isNoOp_){var t=[m,_,k];this.overlays_=t.map(function(t){return e.player_.addChild(new t(e.player_))}),this.enabled_=!0}},n.disable=function(){var e=this;this.enabled_&&(this.enabled_=!1,this.overlays_.forEach(function(t){e.player_.removeChild(t)}),this.delegate("dispose"),this.overlays_=null)},t}(),S=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","mute","unmute","pause","rewind","resume","fullscreen","exitFullscreen","expand","collapse","acceptInvitationLinear","closeLinear","skip","progress","click"],C=["creativeView","click"],E={creativeView:1,start:1,firstQuartile:1,midpoint:1,thirdQuartile:1,complete:1,skip:1},w=["id"],R=["adSystem","adTitle","advertiser","description","error"],P=["adParameters"],L=["absoluteEndTime","absoluteStartTime","ad","clickThroughUrl","companions","primaryCreative","duration","skipOffset"].concat(w).concat(R).concat(P);function M(e){var t={};return e.forEach(function(e){t[e]={ids:[],limit:1/0,time:-1,urls:[]},E.hasOwnProperty(e)&&(t[e].limit=E[e])}),t}var B=function(){function e(e,t){var n=this,i=e.inLine,r=i.creatives,a=r.filter(function(e){return e.linear});this.ad_=e,s(this,e,w),s(this,i,R);var o=this.impressions_={ids:[],limit:1/0,time:-1,urls:[]};o.ids=i.impressions.map(function(e){return e.id}),o.urls=i.impressions.map(function(e){return e.url}),this.primaryCreative_=a[0],this.duration_=c(this.primaryCreative_.linear.duration),s(this,this.primaryCreative_.linear,P);var d=this.primaryCreative_.linear.skipOffset;d?d.indexOf("%")>0?this.skipOffset_=this.duration_*(d.split("%")[0]/100):this.skipOffset_=c(d):this.skipOffset_=-1,this.companions_=[],r.filter(function(e){return e.companionAds}).forEach(function(e){n.companions_=n.companions_.concat(e.companionAds)}),this.clickThroughUrl_=u(this.primaryCreative_,["linear","videoClicks","clickThrough","url"])||"",this.absoluteStartTime_=t,this.absoluteEndTime_=t+this.duration_}var t=e.prototype;return t.impressions=function(){return this.impressions_},t.trackingEvents=function(){if(this.trackingEvents_)return this.trackingEvents_;var e=this.absoluteStartTime_,t=this.absoluteEndTime_,n=this.duration_,i=M(S);i.start.time=Number(e.toFixed(1)),i.firstQuartile.time=Number((e+.25*n).toFixed(1)),i.midpoint.time=Number((e+.5*n).toFixed(1)),i.thirdQuartile.time=Number((e+.75*n).toFixed(1)),i.complete.time=Number(t.toFixed(1));(this.primaryCreative_.linear.trackingEvents||[]).forEach(function(e){i[e.event]&&i[e.event].urls.push(e.url)});var r=u(this.primaryCreative_,["linear","videoClicks","clickTracking"]);return r&&(i.click.urls=r.map(function(e){return e.url})),this.trackingEvents_=i,i},t.companionTrackingEvents=function(){if(this.companionTrackingEvents_)return this.companionTrackingEvents_;var e=M(C);return this.companions_.forEach(function(t){t.trackingEvents&&t.trackingEvents.forEach(function(t){e[t.event]&&e[t.event].urls.push(t.url)}),t.companionClickTracking&&e.click.urls.push(t.companionClickTracking)}),this.companionTrackingEvents_=e,e},e}();L.forEach(function(e){B.prototype[e]=function(){return this[e+"_"]}});var I=function(){function e(e,t){var n=this;void 0===e&&(e=[]),void 0===t&&(t=0),this.absoluteStartTime_=0,this.absoluteEndTime_=0,this.duration_=0,this.startTimeOffset_=t,this.timeOffset_="none",this.type_="none",this.linearAds_=[],e.length&&(this.timeOffset_=e[0].timeOffset,"start"===this.timeOffset_?this.type_="pre":"end"===this.timeOffset_?this.type_="post":(this.type_="mid",this.startTimeOffset_+=c(this.timeOffset_)),this.linearAds_=e.map(function(e,t){var i=u(e,["adSource","vastAdData","vast","ad"]),r=new B(i,n.startTimeOffset_+n.duration_);return n.duration_+=r.duration(),r}),this.absoluteStartTime_=this.first().absoluteStartTime(),this.absoluteEndTime_=this.last().absoluteEndTime())}var t=e.prototype;return t.get=function(e){return this.linearAds_[e]},t.indexOf=function(e){return this.linearAds_.indexOf(e)},t.length=function(){return this.linearAds_.length},t.first=function(){return this.linearAds_[0]||null},t.last=function(){return this.linearAds_[this.linearAds_.length-1]||null},t.isPreRoll=function(){return"pre"===this.type_},t.isMidRoll=function(){return"mid"===this.type_},t.isPostRoll=function(){return"post"===this.type_},e}();function j(e){return e.reduce(function(e,t){return e+t.duration()},0)}function O(e,t){if(!Array.isArray(e.adBreaks)||!e.adBreaks.length)return[];var n=e.adBreaks.filter(function(e){return"linear"===e.breakType&&function(e){return!!u(e,["adSource","vastAdData","vast","ad","inLine","creatives","0","linear","duration"])}(e)}),i=[],r=n.filter(function(e){return"start"===e.timeOffset});r.length&&i.push(new I(r));var a=n.filter(function(e){return"start"!==e.timeOffset&&"end"!==e.timeOffset}),o=[];a.forEach(function(e,t){o.push(e);var n=a[t+1];n&&n.timeOffset===e.timeOffset||(i.push(new I(o,j(i))),o=[])});var s=n.filter(function(e){return"end"===e.timeOffset});if(s.length){var d=j(i)+t;i.push(new I(s,d))}return i}["absoluteStartTime","absoluteEndTime","duration","startTimeOffset","timeOffset","type","linearAds"].forEach(function(e){I.prototype[e]=function(){return this[e+"_"]}});var x=function(){function e(e){this.contentUri_=e.extensions.brightcove.contentUri,this.absoluteDuration_=Number(e.extensions.brightcove.payloadLength),this.contentDuration_=Number(e.extensions.brightcove.contentLength),this.linearAdRolls_=O(e,this.contentDuration_),this.hasEnded_=!1,this.cache_={contentToAbsolute:{}}}var t=e.prototype;return t.get=function(e){return this.linearAdRolls_[e]||null},t.first=function(){return this.linearAdRolls_[0]||null},t.last=function(){return this.linearAdRolls_[this.linearAdRolls_.length-1]||null},t.hasEnded=function(e){if(void 0===e)return this.hasEnded_;this.hasEnded_=Boolean(e)},t.getCurrentLinearAd=function(e){var t=this.getCurrentAdRoll(e);if(!t)return null;for(var n=0;n<t.linearAds().length;n++){var i=t.get(n);if(e>=i.absoluteStartTime()&&e<=i.absoluteEndTime())return i}return null},t.getCurrentAdRoll=function(e){for(var t=0;t<this.linearAdRolls_.length;t++){var n=this.linearAdRolls_[t];if(e>=n.absoluteStartTime()&&e<=n.absoluteEndTime())return n}return null},t.contentToAbsolute=function(e){if(void 0===e&&(e=0),e<0&&(e=0),e>this.contentDuration_&&(e=this.contentDuration_),this.cache_.contentToAbsolute[e])return this.cache_.contentToAbsolute[e];for(var t=e,n=0;n<this.linearAdRolls_.length;n++){var i=this.linearAdRolls_[n];(i.isPreRoll()||i.isMidRoll()&&t>i.startTimeOffset())&&(t+=i.duration())}return this.cache_.contentToAbsolute[e]=t,t},t.stateAtAbsoluteTime=function(e){var t={absoluteTime:e,absoluteDuration:this.absoluteDuration_,relativeTime:e,relativeDuration:this.contentDuration_,linearAdRoll:null,linearAd:null},n=this.hasEnded_;if(e<0)return this.stateAtAbsoluteTime(0);if(e>this.absoluteDuration_)return this.stateAtAbsoluteTime(this.absoluteDuration_);if(!this.linearAdRolls_.length)return t;var i=this.getCurrentLinearAd(e);if(!n&&i)return t.relativeTime-=i.absoluteStartTime(),t.relativeDuration=i.duration(),t.linearAd=i,t.linearAdRoll=this.getCurrentAdRoll(e),t;for(var r=0;r<this.linearAdRolls_.length;r++){var a=this.linearAdRolls_[r];if(!(a.length()&&e>a.absoluteEndTime()))break;t.relativeTime-=a.duration()}return n&&(t.relativeTime=t.relativeDuration),t},e}();["contentUri","absoluteDuration","contentDuration","linearAdRolls"].forEach(function(e){x.prototype[e]=function(){return this[e+"_"]}});var N=function(){function e(e,t){var n=t.enabled;this.linearAd_=e,this.beacons_={},this.enabled_=void 0===n||n,this.enabled_||(this.sendBeacon=function(){})}var n=e.prototype;return n.getBeacon_=function(e){return this.beacons_[e]||(this.beacons_[e]={sent:0,tracked:0}),this.beacons_[e]},n.sentCount=function(e){return this.getBeacon_(e).sent},n.trackedCount=function(e){return this.getBeacon_(e).tracked},n.sendBeacon=function(e){var n,i=this.getBeacon_(e);return i.tracked+=1,!(!((n="impression"===e?this.linearAd_.impressions():this.linearAd_.trackingEvents()[e])&&n.urls&&n.urls.length)||i.sent>=n.limit)&&(n.urls.forEach(function(e){return t.dom.createEl("img",{src:e})}),i.sent+=1,!0)},e}(),D=function(e){return e&&{id:e.getAttribute("id"),url:l(e)}},q=function(e){return e&&{event:e.getAttribute("event"),offset:e.getAttribute("offset"),url:l(e)}},V=function(e){return e&&d(e.querySelectorAll("Tracking"),q)},F=function(e){return e&&{creativeType:e.getAttribute("creativeType")||null,url:l(e)}},U=function(e){if(e)return{id:e.getAttribute("id"),width:e.getAttribute("width"),height:e.getAttribute("height"),assetWidth:e.getAttribute("assetWidth"),assetHeight:e.getAttribute("assetHeight"),expandedWidth:e.getAttribute("expandedWidth"),expandedHeight:e.getAttribute("expandedHeight"),apiFramework:e.getAttribute("apiFramework"),adSlotID:e.getAttribute("adSlotID"),adParameters:l(e.querySelector("AdParameters")),altText:l(e.querySelector("AltText")),companionClickThrough:l(e.querySelector("CompanionClickThrough")),companionClickTracking:l(e.querySelector("CompanionClickTracking")),htmlResource:F(e.querySelector("HTMLResource")),iframeResource:F(e.querySelector("IFrameResource")),staticResource:F(e.querySelector("StaticResource")),trackingEvents:V(e.querySelector("TrackingEvents"))}},H=function(e){return e?{skipOffset:e.getAttribute("skipoffset"),adParameters:l(e.querySelector("AdParameters")),duration:l(e.querySelector("Duration")),trackingEvents:V(e.querySelector("TrackingEvents")),videoClicks:(t=e.querySelector("VideoClicks"),t&&{clickThrough:D(t.querySelector("ClickThrough")),clickTracking:d(t.querySelectorAll("ClickTracking"),D)})}:null;var t},W=function(e){return e&&{id:e.getAttribute("id"),inLine:function(e){if(e){var t=e.querySelector("Creatives").querySelectorAll("Creative");return{adSystem:l(e.querySelector("AdSystem")),adTitle:l(e.querySelector("AdTitle")),advertiser:l(e.querySelector("Advertiser")),description:l(e.querySelector("Description")),error:l(e.querySelector("Error")),impressions:d(e.querySelectorAll("Impression"),D),creatives:d(t,function(e){var t=e.querySelectorAll("CompanionAds > Companion"),n={adID:e.getAttribute("adID"),apiFramework:e.getAttribute("apiFramework"),id:e.getAttribute("id"),sequence:e.getAttribute("sequence"),linear:H(e.querySelector("Linear")),creativeExtensions:d(e.querySelectorAll("CreativeExtensions > CreativeExtension"),function(e){var t={},n=e.querySelector("BrightcoveForeignKey"),i=e.querySelector("WrapperIDs");return t.brightcoveForeignKey=n?l(n):"",t.wrapperIDs=i?l(i).split(","):[],t.wrapperChains=d(e.querySelectorAll("WrapperChain"),function(e){return{adID:e.getAttribute("ad_id"),creativeID:e.getAttribute("creative_id")}}),t})};return!n.linear&&t.length&&(n.companionAds=d(t,U)),n})}}}(e.querySelector("InLine"))}},z=function(t){return t&&{allowMultipleAds:"true"===t.getAttribute("allowMultipleAds"),followRedirects:"true"===t.getAttribute("followRedirects"),id:t.getAttribute("id"),vastAdData:{vast:(n=t.querySelector("VAST"),n&&e.withoutNilValues({ad:W(n.querySelector("Ad"))}))}};var n},Q=function(e){return e&&{breakType:e.getAttribute("breakType"),breakId:e.getAttribute("breakId"),timeOffset:e.getAttribute("timeOffset"),adSource:z(e.querySelector("AdSource"))}},X=function(t,n){var i=n.enableDiscontinuities,r=t.querySelector("VMAP"),a={extensions:{},originalVMAP:r},o=r&&r.querySelector("Extensions > Brightcove")||r.querySelector("Extensions > unicornOnce"),s=o&&o.getAttribute("contenttype"),l=o&&o.getAttribute("contenturi");if(!o||!l||!s)throw new Error("invalid SSAI VMAP");return"audio/x-mpegURL"===s&&(s="application/x-mpegURL"),i&&(l=p(l,{rule:"discos-enabled"})),a.extensions.brightcove={contentLength:o.getAttribute("contentlength"),contentType:s,contentUri:l,payloadLength:o.getAttribute("payloadlength"),ttl:o.getAttribute("ttl")},a.adBreaks=d(r.querySelectorAll("AdBreak"),Q),a=e.withoutNilValues(a)},$="video/vnd.bcov.ssai",Y=/^https?:\/\/once\.unicornmedia\.com/;var K=function(e,t,n){var i=e.timeline_.linearAdRolls(),r=e.playedAdRolls_;if(i&&i.length){for(var a,o=0;o<i.length;o++){var s=i[o];-1===r.indexOf(s)&&(t.absoluteTime>s.absoluteEndTime()||n.absoluteTime>=s.absoluteStartTime()&&(!a||s.absoluteStartTime()>a.absoluteStartTime())&&(a=s))}return a}};function G(e,n,i){var r=e.ssai();try{var a=X(i.src,r.options_);r.enable(a),i.type=a.extensions.brightcove.contentType,i.src=a.extensions.brightcove.contentUri,r.log_("playing vmap",{vmap:a}),n(null,i)}catch(e){t.log.error(e),r.disable(),n(e)}}function J(e){var n=function(t){return function(n){if(!e.usingPlugin("ssai"))return n;var i=e.ssai();return i.state.waiting?n:t(n,i)}};return{setSource:function(n,i){var r,a=function(e){t.log.error(e),i(new Error(e))};if(!e.usingPlugin("ssai"))return a("SSAI plugin not in use.");if("string"!=typeof(r=n.src)&&"[object XMLDocument]"!==Object.prototype.toString.call(r))return e.ssai().disable(),a("SSAI cannot play this source.");var o=e.ssai();if(o.wait(),"string"==typeof n.src){var s={};"number"==typeof o.options_.timeout&&(s.timeout=o.options_.timeout),Y.test(n.src)&&(s.headers={"BCOV-Once-Accept":"application/vnd.apple.mpegurl"});var d=e.ads.adMacroReplacement(n.src,!0);o.options_.enableDiscontinuities&&(d=p(d,{rule:"discos-enabled"})),t.xhr(d,s,function(t,r){var o=r.rawRequest.responseXML;200===r.statusCode&&o?o.getElementsByTagName("parsererror").length?a("SSAI VMAP XML invalid!"):(n.src=o,G(e,i,n)):a("Request for SSAI VMAP XML failed.")})}else G(e,i,n)},duration:n(function(e,t){return t.currentTimelineState().relativeDuration}),currentTime:n(function(e,t){var n=t.currentTimelineState();return n?n.relativeTime:e}),setCurrentTime:n(function(n,i){var r,a=i.currentTimelineState(),o=a.absoluteTime;if(i.log_("setCurrentTime request",{ct:n}),a.linearAd&&i.state.adSeekPreventer)return i.log_("prevented seek during ad",{newTime:o}),o;if(i.resetTimelineEnded_(),a.linearAd){var s=n-a.relativeTime;r=i.absoluteTimelineState(a.absoluteTime+s)}else r=i.contentTimelineState(n);if(o=r.absoluteTime,i.state.adSkipPreventer){var d=K(i,a,r);if(d)return i.log_("seeking to "+n+"s would skip an ad roll",{skippedAdRoll:d}),r.linearAdRoll?(i.seekAfterAd_=i.absoluteTimelineState(r.linearAdRoll.absoluteEndTime()+.05),i.log_("seeking to "+n+"s would seek into an ad roll, going to seek to "+i.seekAfterAd_.relativeTime+", which is after the ad")):i.seekAfterAd_=r,o=d.absoluteStartTime(),t.browser.IS_ANY_SAFARI&&(o+=.4),t.browser.IE_VERSION&&(o+=1),i.log_("setCurrentTime over ad",{ct:n,newTime:o,diff:o-n}),o}return i.log_("setCurrentTime during content",{ct:n,newTime:o,diff:o-n}),o!==n&&(e.trigger("unstable"),e.setTimeout(function(){e.trigger("seek"),e.trigger("seeked")},1)),o}),buffered:n(function(n,i){for(var r=[],a=e.duration(),o=0;o<n.length;o++){var s=n.start(o),d=n.end(o);s>a||(d>a?r.push([s,a]):r.push([s,d]))}return t.createTimeRanges(r)})}}var Z=t.getComponent("Component"),ee=function(e){function t(t,n){var i;i=e.call(this,t,{contentStartTime:n})||this;var r=t.controlBar.getChild("progressControl");if(!r)return a(i);var o=r.getChild("seekBar");return o?(i.hide(),o.addChild(a(a(i))),i):a(i)}return r(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-ssai-ad-marker"});return this.showing_=!1,t.style.left=this.options_.contentStartTime/this.player_.ssai().contentDuration()*100+"%",t},t}(Z);Z.registerComponent("AdMarker",ee);var te=function(e){return{setSource:function(t,n){if(!e.usingPlugin("ssai"))return n(null,t);var i=e.ssai();return u(i,["vmap","extensions","brightcove","contentUri"])!==t.src&&i.disable(),n(null,t)}}};function ne(e){if("string"==typeof e){var t=e.match(/^([\d]+)\.([\d]+)\.([\d]+)/);if(t)return[Number(t[1]),Number(t[2]),Number(t[3])]}}var ie=ne("6.6.1");var re=function(e){function n(n,i){var r;return r=e.call(this,n,i)||this,t.dom.emptyEl(r.el_),r}r(n,e);var i=n.prototype;return i.buildCSSClass=function(){return h("ad-click-target")},i.inject=function(){var e=this.player_.tech(!0).el();e.parentNode.insertBefore(this.el_,e.nextSibling)},i.handleClick=function(){var e,t=this.player_.ssai().currentLinearAd();this.player_.trigger({type:(e="click-through",void 0===e&&(e=""),"bcov-ssai"+(e?"-"+e:"")),linearAd:t})},n}(t.getComponent("ClickableComponent"));re.defaultState={enabled:!0},t.registerComponent("SsaiAdClickTarget",re);var ae="6.6.1";var oe=function(e,t){t.isImmediatePropagationStopped=function(){return!0},t.cancelBubble=!0,t.isPropagationStopped=function(){return!0}},se=function(e,t,n){oe(0,n),e.trigger({type:t+n.type,originalEvent:n})},de=function(e,t){e.ads.isInAdMode()&&(e.ads.isContentResuming()?e.ads._contentEnding&&se(e,"content",t):se(e,"ad",t))},le=function(e,t){e.ads.isInAdMode()?e.ads.isContentResuming()?(oe(0,t),e.trigger("resumeended")):se(e,"ad",t):e.ads._contentHasEnded||e.ads.stitchedAds()||(se(e,"content",t),e.trigger("readyforpostroll"))},ue=function(e,t){if(!("loadstart"===t.type&&!e.ads._hasThereBeenALoadStartDuringPlayerLife||"loadeddata"===t.type&&!e.ads._hasThereBeenALoadedData||"loadedmetadata"===t.type&&!e.ads._hasThereBeenALoadedMetaData))if(e.ads.inAdBreak())se(e,"ad",t);else{if(e.currentSrc()!==e.ads.contentSrc)return;se(e,"content",t)}},ce=function(e,t){e.ads.inAdBreak()?se(e,"ad",t):e.ads.isContentResuming()&&se(e,"content",t)};function he(e){"playing"===e.type?de(this,e):"ended"===e.type?le(this,e):"loadstart"===e.type||"loadeddata"===e.type||"loadedmetadata"===e.type?ue(this,e):"play"===e.type?ce(this,e):this.ads.isInAdMode()&&(this.ads.isContentResuming()?se(this,"content",e):se(this,"ad",e))}var pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ge=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},me=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},ve=function(e,t){return t?encodeURIComponent(e):e},ye=function(e,t,n){if(e&&e[n])for(var i=e[n],r=Object.keys(i),a=0;a<r.length;a++){t["{mediainfo."+n+"."+r[a]+"}"]=i[r[a]]}};var _e={processMetadataTracks:function(e,t){for(var n=e.textTracks(),i=function(n){"metadata"===n.kind&&(e.ads.cueTextTracks.setMetadataTrackMode(n),t(e,n))},r=0;r<n.length;r++)i(n[r]);n.addEventListener("addtrack",function(e){i(e.track)})},setMetadataTrackMode:function(e){},getSupportedAdCue:function(e,t){return t},isSupportedAdCue:function(e,t){return!0},getCueId:function(e,t){return t.id}},Ae=function(e,t){return void 0!==t&&e.ads.includedCues[t]},be=function(e,t){void 0!==t&&""!==t&&(e.ads.includedCues[t]=!0)};function ke(){!1!==this.ads._shouldBlockPlay&&(this.paused()||(this.ads.debug("Playback was canceled by cancelContentPlay"),this.pause()),this.ads._cancelledPlay=!0)}_e.processAdTrack=function(e,n,i,r){e.ads.includedCues={};for(var a=0;a<n.length;a++){var o=n[a],s=this.getSupportedAdCue(e,o);if(!this.isSupportedAdCue(e,o))return void t.log.warn("Skipping as this is not a supported ad cue.",o);var d=this.getCueId(e,o),l=o.startTime;if(Ae(e,d))return void t.log("Skipping ad already seen with ID "+d);r&&r(e,s,d,l),i(e,s,d,l),be(e,d)}};var Te={},Se=t;Te.isMiddlewareMediatorSupported=function(){return!Se.browser.IS_IOS&&!Se.browser.IS_ANDROID&&!!(Se.use&&Se.middleware&&Se.middleware.TERMINATOR)},Te.playMiddleware=function(e){return{setSource:function(e,t){t(null,e)},callPlay:function(){if(e.ads&&!0===e.ads._shouldBlockPlay)return e.ads.debug("Using playMiddleware to block content playback"),e.ads._playBlocked=!0,Se.middleware.TERMINATOR},play:function(t,n){e.ads&&e.ads._playBlocked&&t?(e.ads.debug("Play call to Tech was terminated."),e.trigger("play"),e.addClass("vjs-has-started"),e.ads._playBlocked=!1):n&&n.catch&&n.catch(function(t){"play() failed because the user didn't interact with the document first. https://goo.gl/xX8pDD"===t.message&&e.trigger("pause")})}}},Te.testHook=function(e){Se=e};var Ce=Te.playMiddleware,Ee=Te.isMiddlewareMediatorSupported,we=function(){if(t.getPlugin)return Boolean(t.getPlugin("ads"));var e=t.getComponent("Player");return Boolean(e&&e.prototype.ads)};var Re=function(){function e(t){fe(this,e),this.player=t}return e._getName=function(){return"Anonymous State"},e.prototype.transitionTo=function(e){var t=this.player;this.cleanup(t);var n=new e(t);t.ads._state=n,t.ads.debug(this.constructor._getName()+" -> "+n.constructor._getName());for(var i=arguments.length,r=Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];n.init.apply(n,[t].concat(r))},e.prototype.init=function(){},e.prototype.cleanup=function(){},e.prototype.onPlay=function(){},e.prototype.onPlaying=function(){},e.prototype.onEnded=function(){},e.prototype.onAdEnded=function(){},e.prototype.onAdsReady=function(){t.log.warn("Unexpected adsready event")},e.prototype.onAdsError=function(){},e.prototype.onAdsCanceled=function(){},e.prototype.onAdTimeout=function(){},e.prototype.onAdStarted=function(){},e.prototype.onContentChanged=function(){},e.prototype.onContentResumed=function(){},e.prototype.onReadyForPostroll=function(){t.log.warn("Unexpected readyforpostroll event")},e.prototype.onNoPreroll=function(){},e.prototype.onNoPostroll=function(){},e.prototype.startLinearAdMode=function(){t.log.warn("Unexpected startLinearAdMode invocation (State via "+this.constructor._getName()+")")},e.prototype.endLinearAdMode=function(){t.log.warn("Unexpected endLinearAdMode invocation (State via "+this.constructor._getName()+")")},e.prototype.skipLinearAdMode=function(){t.log.warn("Unexpected skipLinearAdMode invocation (State via "+this.constructor._getName()+")")},e.prototype.isAdState=function(){throw new Error("isAdState unimplemented for "+this.constructor._getName())},e.prototype.isWaitingForAdBreak=function(){return!1},e.prototype.isContentResuming=function(){return!1},e.prototype.inAdBreak=function(){return!1},e.prototype.handleEvent=function(e){var t=this.player;"play"===e?this.onPlay(t):"adsready"===e?this.onAdsReady(t):"adserror"===e?this.onAdsError(t):"adscanceled"===e?this.onAdsCanceled(t):"adtimeout"===e?this.onAdTimeout(t):"ads-ad-started"===e?this.onAdStarted(t):"contentchanged"===e?this.onContentChanged(t):"contentresumed"===e?this.onContentResumed(t):"readyforpostroll"===e?this.onReadyForPostroll(t):"playing"===e?this.onPlaying(t):"ended"===e?this.onEnded(t):"nopreroll"===e?this.onNoPreroll(t):"nopostroll"===e?this.onNoPostroll(t):"adended"===e&&this.onAdEnded(t)},e}(),Pe=function(e){function t(n){fe(this,t);var i=me(this,e.call(this,n));return i.contentResuming=!1,i.waitingForAdBreak=!1,i}return ge(t,e),t.prototype.isAdState=function(){return!0},t.prototype.onPlaying=function(){this.contentResuming&&this.transitionTo(Ne)},t.prototype.onContentResumed=function(){this.contentResuming&&this.transitionTo(Ne)},t.prototype.isWaitingForAdBreak=function(){return this.waitingForAdBreak},t.prototype.isContentResuming=function(){return this.contentResuming},t.prototype.inAdBreak=function(){return!0===this.player.ads._inLinearAdMode},t}(Re),Le=function(e){function t(){return fe(this,t),me(this,e.apply(this,arguments))}return ge(t,e),t.prototype.isAdState=function(){return!1},t.prototype.onContentChanged=function(e){e.ads.debug("Received contentchanged event (ContentState)"),e.paused()?this.transitionTo(xe):(this.transitionTo(Ie,!1),e.pause(),e.ads._pausedOnContentupdate=!0)},t}(Re),Me=void 0;var Be={start:function(e){e.ads.debug("Starting ad break"),e.ads._inLinearAdMode=!0,e.trigger("adstart"),e.ads.shouldTakeSnapshots()&&(e.ads.snapshot=function(e){var n=void 0;n=t.browser.IS_IOS&&e.ads.isLive(e)&&e.seekable().length>0?e.currentTime()-e.seekable().end(0):e.currentTime();var i=e.$(".vjs-tech"),r=e.textTracks?e.textTracks():[],a=[],o={ended:e.ended(),currentSrc:e.currentSrc(),sources:e.currentSources(),src:e.tech_.src(),currentTime:n,type:e.currentType()};i&&(o.style=i.getAttribute("style"));for(var s=0;s<r.length;s++){var d=r[s];a.push({track:d,mode:d.mode}),d.mode="disabled"}return o.suppressedTracks=a,o}(e)),e.ads.shouldPlayContentBehindAd(e)&&(e.ads.preAdVolume_=e.volume(),e.volume(0)),e.addClass("vjs-ad-playing"),e.hasClass("vjs-live")&&e.removeClass("vjs-live"),e.ads.removeNativePoster()},end:function(e,n){e.ads.debug("Ending ad break"),void 0===n&&(n=function(){}),e.ads.adType=null,e.ads._inLinearAdMode=!1,e.trigger("adend"),e.removeClass("vjs-ad-playing"),e.ads.isLive(e)&&e.addClass("vjs-live"),e.ads.shouldTakeSnapshots()?function(e,n){var i=e.ads.snapshot;if(void 0===n&&(n=function(){}),!0===e.ads.disableNextSnapshotRestore)return e.ads.disableNextSnapshotRestore=!1,delete e.ads.snapshot,void n();var r=e.$(".vjs-tech"),a=20,o=i.suppressedTracks,s=void 0,d=function(){for(var e=0;e<o.length;e++)(s=o[e]).track.mode=s.mode},l=function(){var n=void 0;if(t.browser.IS_IOS&&e.ads.isLive(e)){if(i.currentTime<0&&(n=e.seekable().length>0?e.seekable().end(0)+i.currentTime:e.currentTime(),e.currentTime(n)),e.paused()){var r=e.play();r&&r.catch&&r.catch(function(e){t.log.warn("Play promise rejected in IOS snapshot resume",e)})}}else if(i.ended)e.currentTime(e.duration());else{e.currentTime(i.currentTime);var a=e.play();a&&a.catch&&a.catch(function(e){t.log.warn("Play promise rejected in snapshot resume",e)})}e.ads.shouldRemoveAutoplay_&&(e.autoplay(!1),e.ads.shouldRemoveAutoplay_=!1)},u=function n(){if(e.off("contentcanplay",n),Me&&e.clearTimeout(Me),(r=e.el().querySelector(".vjs-tech")).readyState>1)return l();if(void 0===r.seekable)return l();if(r.seekable.length>0)return l();if(a--)e.setTimeout(n,50);else try{l()}catch(e){t.log.warn("Failed to resume the content after an advertisement",e)}};if("style"in i&&r.setAttribute("style",i.style||""),e.ads.videoElementRecycled())e.one("resumeended",function(){delete e.ads.snapshot,n()}),e.one("contentloadedmetadata",d),t.browser.IS_IOS&&!e.autoplay()&&(e.autoplay(!0),e.ads.shouldRemoveAutoplay_=!0),e.src(i.sources),e.one("contentcanplay",u),Me=e.setTimeout(u,2e3);else{if(d(),!e.ended()){var c=e.play();c&&c.catch&&c.catch(function(e){t.log.warn("Play promise rejected in snapshot restore",e)})}delete e.ads.snapshot,n()}}(e,n):(e.volume(e.ads.preAdVolume_),n())}},Ie=function(e){function n(){return fe(this,n),me(this,e.apply(this,arguments))}return ge(n,e),n._getName=function(){return"Preroll"},n.prototype.init=function(e,t,n){if(this.waitingForAdBreak=!0,e.addClass("vjs-ad-loading"),n||e.ads.nopreroll_)return this.resumeAfterNoPreroll(e);var i=e.ads.settings.timeout;"number"==typeof e.ads.settings.prerollTimeout&&(i=e.ads.settings.prerollTimeout),this._timeout=e.setTimeout(function(){e.trigger("adtimeout")},i),t?this.handleAdsReady():this.adsReady=!1},n.prototype.onAdsReady=function(e){e.ads.inAdBreak()?t.log.warn("Unexpected adsready event (Preroll)"):(e.ads.debug("Received adsready event (Preroll)"),this.handleAdsReady())},n.prototype.handleAdsReady=function(){this.adsReady=!0,this.readyForPreroll()},n.prototype.afterLoadStart=function(e){var t=this.player;t.ads._hasThereBeenALoadStartDuringPlayerLife?e():(t.ads.debug("Waiting for loadstart..."),t.one("loadstart",function(){t.ads.debug("Received loadstart event"),e()}))},n.prototype.noPreroll=function(){var e=this;this.afterLoadStart(function(){e.player.ads.debug("Skipping prerolls due to nopreroll event (Preroll)"),e.resumeAfterNoPreroll(e.player)})},n.prototype.readyForPreroll=function(){var e=this.player;this.afterLoadStart(function(){e.ads.debug("Triggered readyforpreroll event (Preroll)"),e.trigger("readyforpreroll")})},n.prototype.onAdsCanceled=function(e){var t=this;e.ads.debug("adscanceled (Preroll)"),this.afterLoadStart(function(){t.resumeAfterNoPreroll(e)})},n.prototype.onAdsError=function(e){var n=this;t.log("adserror (Preroll)"),this.inAdBreak()?e.ads.endLinearAdMode():this.afterLoadStart(function(){n.resumeAfterNoPreroll(e)})},n.prototype.startLinearAdMode=function(){var e=this.player;!this.adsReady||e.ads.inAdBreak()||this.isContentResuming()?t.log.warn("Unexpected startLinearAdMode invocation (Preroll)"):(e.clearTimeout(this._timeout),e.ads.adType="preroll",this.waitingForAdBreak=!1,Be.start(e),e.ads._shouldBlockPlay=!1)},n.prototype.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.prototype.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(e.removeClass("vjs-ad-loading"),e.addClass("vjs-ad-content-resuming"),this.contentResuming=!0,Be.end(e))},n.prototype.skipLinearAdMode=function(){var e=this,n=this.player;n.ads.inAdBreak()||this.isContentResuming()?t.log.warn("Unexpected skipLinearAdMode invocation"):this.afterLoadStart(function(){n.trigger("adskip"),n.ads.debug("skipLinearAdMode (Preroll)"),e.resumeAfterNoPreroll(n)})},n.prototype.onAdTimeout=function(e){var t=this;this.afterLoadStart(function(){e.ads.debug("adtimeout (Preroll)"),t.resumeAfterNoPreroll(e)})},n.prototype.onNoPreroll=function(e){e.ads.inAdBreak()||this.isContentResuming()?t.log.warn("Unexpected nopreroll event (Preroll)"):this.noPreroll()},n.prototype.resumeAfterNoPreroll=function(e){this.contentResuming=!0,e.ads._shouldBlockPlay=!1,e.paused()&&(e.ads._playRequested||e.ads._pausedOnContentupdate)&&e.play()},n.prototype.cleanup=function(e){e.ads._hasThereBeenALoadStartDuringPlayerLife||t.log.warn("Leaving Preroll state before loadstart event can cause issues."),e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming"),e.clearTimeout(this._timeout)},n}(Pe),je=function(e){function t(){return fe(this,t),me(this,e.apply(this,arguments))}return ge(t,e),t._getName=function(){return"Midroll"},t.prototype.init=function(e){e.ads.adType="midroll",Be.start(e),e.addClass("vjs-ad-loading")},t.prototype.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},t.prototype.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(this.contentResuming=!0,e.addClass("vjs-ad-content-resuming"),e.removeClass("vjs-ad-loading"),Be.end(e))},t.prototype.onAdsError=function(e){this.inAdBreak()&&e.ads.endLinearAdMode()},t.prototype.cleanup=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming")},t}(Pe),Oe=function(e){function n(){return fe(this,n),me(this,e.apply(this,arguments))}return ge(n,e),n._getName=function(){return"Postroll"},n.prototype.init=function(e){if(this.waitingForAdBreak=!0,e.ads._contentEnding=!0,e.ads.nopostroll_)this.resumeContent(e),this.transitionTo(De);else{e.addClass("vjs-ad-loading");var t=e.ads.settings.timeout;"number"==typeof e.ads.settings.postrollTimeout&&(t=e.ads.settings.postrollTimeout),this._postrollTimeout=e.setTimeout(function(){e.trigger("adtimeout")},t)}},n.prototype.startLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?t.log.warn("Unexpected startLinearAdMode invocation (Postroll)"):(e.ads.adType="postroll",e.clearTimeout(this._postrollTimeout),this.waitingForAdBreak=!1,Be.start(e))},n.prototype.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.prototype.endLinearAdMode=function(){var e=this,t=this.player;this.inAdBreak()&&(t.removeClass("vjs-ad-loading"),this.resumeContent(t),Be.end(t,function(){e.transitionTo(De)}))},n.prototype.skipLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?t.log.warn("Unexpected skipLinearAdMode invocation"):(e.ads.debug("Postroll abort (skipLinearAdMode)"),e.trigger("adskip"),this.abort(e))},n.prototype.onAdTimeout=function(e){e.ads.debug("Postroll abort (adtimeout)"),this.abort(e)},n.prototype.onAdsError=function(e){e.ads.debug("Postroll abort (adserror)"),e.ads.inAdBreak()?e.ads.endLinearAdMode():this.abort(e)},n.prototype.onContentChanged=function(e){this.isContentResuming()?this.transitionTo(xe):this.inAdBreak()||this.transitionTo(Ie)},n.prototype.onNoPostroll=function(e){this.isContentResuming()||this.inAdBreak()?t.log.warn("Unexpected nopostroll event (Postroll)"):this.abort(e)},n.prototype.resumeContent=function(e){this.contentResuming=!0,e.addClass("vjs-ad-content-resuming")},n.prototype.abort=function(e){this.resumeContent(e),e.removeClass("vjs-ad-loading"),this.transitionTo(De)},n.prototype.cleanup=function(e){e.removeClass("vjs-ad-content-resuming"),e.clearTimeout(this._postrollTimeout),e.ads._contentEnding=!1},n}(Pe),xe=function(e){function t(){return fe(this,t),me(this,e.apply(this,arguments))}return ge(t,e),t._getName=function(){return"BeforePreroll"},t.prototype.init=function(e){this.adsReady=!1,this.shouldResumeToContent=!1,e.ads._shouldBlockPlay=!0},t.prototype.onAdsReady=function(e){e.ads.debug("Received adsready event (BeforePreroll)"),this.adsReady=!0},t.prototype.onPlay=function(e){e.ads.debug("Received play event (BeforePreroll)"),this.transitionTo(Ie,this.adsReady,this.shouldResumeToContent)},t.prototype.onAdsCanceled=function(e){e.ads.debug("adscanceled (BeforePreroll)"),this.shouldResumeToContent=!0},t.prototype.onAdsError=function(){this.player.ads.debug("adserror (BeforePreroll)"),this.shouldResumeToContent=!0},t.prototype.onNoPreroll=function(){this.player.ads.debug("Skipping prerolls due to nopreroll event (BeforePreroll)"),this.shouldResumeToContent=!0},t.prototype.skipLinearAdMode=function(){var e=this.player;e.trigger("adskip"),e.ads.debug("skipLinearAdMode (BeforePreroll)"),this.shouldResumeToContent=!0},t.prototype.onContentChanged=function(){this.init(this.player)},t}(Le),Ne=function(e){function t(){return fe(this,t),me(this,e.apply(this,arguments))}return ge(t,e),t._getName=function(){return"ContentPlayback"},t.prototype.init=function(e){e.ads._shouldBlockPlay=!1},t.prototype.onAdsReady=function(e){e.ads.debug("Received adsready event (ContentPlayback)"),e.ads.nopreroll_||(e.ads.debug("Triggered readyforpreroll event (ContentPlayback)"),e.trigger("readyforpreroll"))},t.prototype.onReadyForPostroll=function(e){e.ads.debug("Received readyforpostroll event"),this.transitionTo(Oe)},t.prototype.startLinearAdMode=function(){this.transitionTo(je)},t}(Le),De=function(e){function n(){return fe(this,n),me(this,e.apply(this,arguments))}return ge(n,e),n._getName=function(){return"AdsDone"},n.prototype.init=function(e){e.ads._contentHasEnded=!0,e.trigger("ended")},n.prototype.startLinearAdMode=function(){t.log.warn("Unexpected startLinearAdMode invocation (AdsDone)")},n}(Le),qe=function(e){function t(){return fe(this,t),me(this,e.apply(this,arguments))}return ge(t,e),t._getName=function(){return"StitchedAdRoll"},t.prototype.init=function(){this.waitingForAdBreak=!1,this.contentResuming=!1,this.player.ads.adType="stitched",Be.start(this.player)},t.prototype.onPlaying=function(){},t.prototype.onContentResumed=function(){},t.prototype.onAdEnded=function(){this.endLinearAdMode(),this.player.trigger("ended")},t.prototype.endLinearAdMode=function(){Be.end(this.player),this.transitionTo(Ve)},t}(Pe),Ve=function(e){function t(){return fe(this,t),me(this,e.apply(this,arguments))}return ge(t,e),t._getName=function(){return"StitchedContentPlayback"},t.prototype.init=function(){this.player.ads._shouldBlockPlay=!1},t.prototype.onContentChanged=function(){this.player.ads.debug("Received contentchanged event ("+this._getName()+")")},t.prototype.startLinearAdMode=function(){this.transitionTo(qe)},t}(Le),Fe=Te.isMiddlewareMediatorSupported,Ue=t.getTech("Html5").Events,He={timeout:5e3,prerollTimeout:void 0,postrollTimeout:void 0,debug:!1,stitchedAds:!1,contentIsLive:void 0,liveCuePoints:!0},We=function(e){var r=this,a=t.mergeOptions(He,e),o=Ue.concat(["firstplay","loadedalldata","playing"]);r.on(o,he),Fe()||function(e,n){n&&t.log("Using cancelContentPlay to block content playback"),e.on("play",ke)}(r,a.debug),r.setTimeout(function(){r.ads._hasThereBeenALoadStartDuringPlayerLife||""===r.src()||t.log.error("videojs-contrib-ads has not seen a loadstart event 5 seconds after being initialized, but a source is present. This indicates that videojs-contrib-ads was initialized too late. It must be initialized immediately after video.js in the same tick. As a result, some ads will not play and some media events will be incorrect. For more information, see http://videojs.github.io/videojs-contrib-ads/integrator/getting-started.html")},5e3),r.on("ended",function(){r.hasClass("vjs-has-started")||r.addClass("vjs-has-started")}),r.on("contenttimeupdate",function(){r.removeClass("vjs-waiting")}),r.on(["addurationchange","adcanplay"],function(){if((!r.ads.snapshot||r.currentSrc()!==r.ads.snapshot.currentSrc)&&r.ads.inAdBreak()){var e=r.play();e&&e.catch&&e.catch(function(e){t.log.warn("Play promise rejected when playing ad",e)})}}),r.on("nopreroll",function(){r.ads.debug("Received nopreroll event"),r.ads.nopreroll_=!0}),r.on("nopostroll",function(){r.ads.debug("Received nopostroll event"),r.ads.nopostroll_=!0}),r.on("playing",function(){r.ads._cancelledPlay=!1,r.ads._pausedOnContentupdate=!1}),r.on("play",function(){r.ads._playRequested=!0}),r.one("loadstart",function(){r.ads._hasThereBeenALoadStartDuringPlayerLife=!0}),r.on("loadeddata",function(){r.ads._hasThereBeenALoadedData=!0}),r.on("loadedmetadata",function(){r.ads._hasThereBeenALoadedMetaData=!0}),r.ads=function(e){return{disableNextSnapshotRestore:!1,_contentEnding:!1,_contentHasEnded:!1,_hasThereBeenALoadStartDuringPlayerLife:!1,_hasThereBeenALoadedData:!1,_hasThereBeenALoadedMetaData:!1,_inLinearAdMode:!1,_shouldBlockPlay:!1,_playBlocked:!1,_playRequested:!1,adType:null,VERSION:ae,reset:function(){e.ads.disableNextSnapshotRestore=!1,e.ads._contentEnding=!1,e.ads._contentHasEnded=!1,e.ads.snapshot=null,e.ads.adType=null,e.ads._hasThereBeenALoadedData=!1,e.ads._hasThereBeenALoadedMetaData=!1,e.ads._cancelledPlay=!1,e.ads._shouldBlockPlay=!1,e.ads._playBlocked=!1,e.ads.nopreroll_=!1,e.ads.nopostroll_=!1,e.ads._playRequested=!1},startLinearAdMode:function(){e.ads._state.startLinearAdMode()},endLinearAdMode:function(){e.ads._state.endLinearAdMode()},skipLinearAdMode:function(){e.ads._state.skipLinearAdMode()},stitchedAds:function(e){return void 0!==e&&(t.log.warn("Using player.ads.stitchedAds() as a setter is deprecated, it should be set as an option upon initialization of contrib-ads."),this.settings.stitchedAds=!!e),this.settings.stitchedAds},videoElementRecycled:function(){if(e.ads.shouldPlayContentBehindAd(e))return!1;if(!this.snapshot)throw new Error("You cannot use videoElementRecycled while there is no snapshot.");var t=e.tech_.src()!==this.snapshot.src,n=e.currentSrc()!==this.snapshot.currentSrc;return t||n},isLive:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;return"boolean"==typeof n.ads.settings.contentIsLive?n.ads.settings.contentIsLive:n.duration()===1/0||"8"===t.browser.IOS_VERSION&&0===n.duration()},shouldPlayContentBehindAd:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;if(n)return!!n.ads.settings.liveCuePoints&&!t.browser.IS_IOS&&!t.browser.IS_ANDROID&&n.duration()===1/0;throw new Error("shouldPlayContentBehindAd requires a player as a param")},shouldTakeSnapshots:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;return!this.shouldPlayContentBehindAd(t)&&!this.stitchedAds()},isInAdMode:function(){return this._state.isAdState()},isWaitingForAdBreak:function(){return this._state.isWaitingForAdBreak()},isContentResuming:function(){return this._state.isContentResuming()},isAdPlaying:function(){return this._state.inAdBreak()},inAdBreak:function(){return this._state.inAdBreak()},removeNativePoster:function(){var t=e.$(".vjs-tech");t&&t.removeAttribute("poster")},debug:function(){if(this.settings.debug){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];1===n.length&&"string"==typeof n[0]?t.log("ADS: "+n[0]):t.log.apply(t,["ADS:"].concat(n))}}}}(r),r.ads.settings=a,a.stitchedAds=!!a.stitchedAds,a.stitchedAds?r.ads._state=new Ve(r):r.ads._state=new xe(r),r.ads._state.init(r),r.ads.cueTextTracks=_e,r.ads.adMacroReplacement=function(e,r,a){var o=this,s={};e=e.replace(/{([^}=]+)=([^}]+)}/g,function(e,t,n){return s["{"+t+"}"]=n,"{"+t+"}"}),void 0===r&&(r=!1);var d={};for(var l in void 0!==a&&(d=a),d["{player.id}"]=this.options_["data-player"],d["{mediainfo.id}"]=this.mediainfo?this.mediainfo.id:"",d["{mediainfo.name}"]=this.mediainfo?this.mediainfo.name:"",d["{mediainfo.duration}"]=this.mediainfo?this.mediainfo.duration:"",d["{player.duration}"]=this.duration(),d["{timestamp}"]=(new Date).getTime(),d["{document.referrer}"]=i.referrer,d["{window.location.href}"]=n.location.href,d["{random}"]=Math.floor(1e12*Math.random()),["description","tags","reference_id","ad_keys"].forEach(function(e){o.mediainfo&&o.mediainfo[e]?d["{mediainfo."+e+"}"]=o.mediainfo[e]:s["{mediainfo."+e+"}"]?d["{mediainfo."+e+"}"]=s["{mediainfo."+e+"}"]:d["{mediainfo."+e+"}"]=""}),ye(this.mediainfo,d,"custom_fields"),ye(this.mediainfo,d,"customFields"),d)e=e.split(l).join(ve(d[l],r));for(var u in e=e.replace(/{pageVariable\.([^}]+)}/g,function(e,i){for(var a=void 0,o=n,d=i.split("."),l=0;l<d.length;l++)l===d.length-1?a=o[d[l]]:o=o[d[l]];var u=void 0===a?"undefined":pe(a);return null===a?"null":void 0===a?s["{pageVariable."+i+"}"]?s["{pageVariable."+i+"}"]:(t.log.warn('Page variable "'+i+'" not found'),""):"string"!==u&&"number"!==u&&"boolean"!==u?(t.log.warn('Page variable "'+i+'" is not a supported type'),""):ve(String(a),r)}),s)e=e.replace(u,s[u]);return e}.bind(r),function(e){e.ads.contentSrc=e.currentSrc(),e.ads._seenInitialLoadstart=!1,e.on("loadstart",function(){if(!e.ads.inAdBreak()){var t=e.currentSrc();t!==e.ads.contentSrc&&(e.ads._seenInitialLoadstart&&e.trigger({type:"contentchanged"}),e.trigger({type:"contentupdate",oldValue:e.ads.contentSrc,newValue:t}),e.ads.contentSrc=t),e.ads._seenInitialLoadstart=!0}})}(r),r.on("contentchanged",r.ads.reset);var s=function(){var e=r.textTracks();if(!r.ads.shouldPlayContentBehindAd(r)&&r.ads.inAdBreak()&&r.tech_.featuresNativeTextTracks&&t.browser.IS_IOS&&!Array.isArray(r.textTracks()))for(var n=0;n<e.length;n++){var i=e[n];"showing"===i.mode&&(i.mode="disabled")}};r.ready(function(){r.textTracks().addEventListener("change",s)}),r.on(["play","playing","ended","adsready","adscanceled","adskip","adserror","adtimeout","adended","ads-ad-started","contentchanged","dispose","contentresumed","readyforpostroll","nopreroll","nopostroll"],function(e){r.ads._state.handleEvent(e.type)}),r.on("dispose",function(){r.ads.reset(),r.textTracks().removeEventListener("change",s)})};We.VERSION=ae,function(e){!we(t)&&((t.registerPlugin||t.plugin)("ads",e),Ee()&&!t.usingContribAdsMiddleware_&&(t.use("*",Ce),t.usingContribAdsMiddleware_=!0,t.log("Play middleware has been registered with videojs")))}(We);var ze=n.Date,Qe={debug:!1,enableDiscontinuities:!(t.browser.IS_EDGE||t.browser.IE_VERSION),fakeEnded:!0,hideOverlays:!1,trackingBeacons:!0,timeout:45e3,vmapURL:"",vmapXML:null,experimentalLiveSupport:!1},Xe={enabled:["disabled","enabled"],waiting:["not-waiting","waiting"]},$e=function(e){function i(n,i){var r;return i=(r=e.call(this,n,i)||this).options_=t.mergeOptions(Qe,i),r.log_("constructed",{options:i}),n.usingPlugin("ads")||n.ads({debug:Boolean(i.debug),stitchedAds:!0}),r.playedAdRolls_=[],r.overlayManager_=new T(n,i.hideOverlays),r.fakeEnded_=r.options_.fakeEnded,r.ssaiAdClickTarget_=n.addChild("ssaiAdClickTarget"),r.ssaiAdClickTarget_.inject(),n.addClass(h()),n.addClass(h("disabled")),i.hideOverlays?n.addClass(h("hide-overlays")):n.addClass(h("show-overlays")),r.on("statechanged",r.onStateChanged_),r.on("dispose",r.onDispose_),i.vmapURL?n.src({type:$,src:i.vmapURL}):i.vmapXML&&n.src({type:$,src:i.vmapXML}),r}r(i,e);var a=i.prototype;return a.wait=function(){this.log_("wait"),this.timeline_=this.vmap=null,this.toggleListeners_("off"),this.overlayManager_.disable(),this.setState({waiting:!0})},a.enable=function(e){var t=this,n=this.player;this.log_("enable"),this.state.enabled&&this.disable(),this.timeline_=new x(e),this.vmap=e,"object"==typeof n.seekEvents&&"function"==typeof n.seekEvents.disable&&n.seekEvents.disable(),this.toggleListeners_("on"),this.overlayManager_.enable();var i=this.timeline_.linearAdRolls();this.adMarkers_=[],i.forEach(function(e){if(!e.isPreRoll()&&!e.isPostRoll()){var i=t.absoluteTimelineState(e.absoluteStartTime()-.05);t.adMarkers_.push(new ee(n,i.relativeTime))}}),this.callSubsCapsButton_("update"),this.setState({enabled:!0,waiting:!1,adSkipPreventer:!0,adSeekPreventer:!0})},a.disable=function(){var e=this.player;this.log_("disable"),this.timeline_=this.vmap=null,"object"==typeof e.seekEvents&&"function"==typeof e.seekEvents.enable&&e.seekEvents.enable(),this.toggleListeners_("off"),this.overlayManager_.disable(),this.adMarkers_&&(this.adMarkers_.forEach(function(e){return e.dispose()}),this.adMarkers_.length=0),this.callSubsCapsButton_("update"),this.setState({enabled:!1,waiting:!1,adSkipPreventer:!1,adSeekPreventer:!1})},a.absoluteDuration=function(){if(this.timeline_)return this.timeline_.absoluteDuration()},a.contentDuration=function(){if(this.timeline_)return this.timeline_.contentDuration()},a.absoluteTimelineState=function(e){if(this.timeline_)return this.timeline_.stateAtAbsoluteTime(e)},a.contentTimelineState=function(e){if(this.timeline_){var t=this.timeline_.contentToAbsolute(e);return this.timeline_.stateAtAbsoluteTime(t)}},a.currentTimelineState=function(){if(this.timeline_)return this.timeline_.stateAtAbsoluteTime(this.player.tech(!0).currentTime())},a.relativeTimelineState=function(){if(this.timeline_)return this.timeline_.stateAtAbsoluteTime(this.player.currentTime())},a.seekInAbsoluteTime=function(e,t){if(this.timeline_){t||this.allowSeekingOverAds_(),this.log_("programmatic seek",{from:this.player.tech(!0).currentTime(),to:e,adState:this.player.ads.state});var n=this.player.tech(!0).setCurrentTime(e);return this.fire_("seek"),n}},a.seekInRelativeTime=function(e,t){if(this.timeline_){var n=this.currentTimelineState();return n.linearAd?this.seekInAbsoluteTime(n.linearAd.absoluteStartTime()+e,!0):this.seekInAbsoluteTime(e,t)}},a.seekInContentTime=function(e,t){if(this.timeline_){var n=this.timeline_.contentToAbsolute(e);return this.seekInAbsoluteTime(n,t)}},a.currentLinearAd=function(){return this.currentLinearAd_},a.log_=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var a;this.player.usingPlugin("bcAnalyticsLogger")&&(a=this.player.bcAnalyticsLogger()).add.apply(a,["SSAI",e].concat(i));this.options_.debug&&t.log.apply(t,[e].concat(i))},a.sendBeacon_=function(e){if(this.currentLinearAdTracker_){var t=this.currentLinearAdTracker_.sendBeacon(e);return t&&this.log_("beacon",{type:e}),t}},a.fire_=function(e){"string"==typeof e&&(e={type:e}),this.log_('fire event "'+e.type+'"'),this.player.trigger(e)},a.allowSeekingOverAds_=function(){var e=this,t={adSeekPreventer:this.state.adSeekPreventer,adSkipPreventer:this.state.adSkipPreventer};this.setState({adSeekPreventer:!1,adSkipPreventer:!1}),this.player.one(["adseeked","seeked","adend"],function n(){e.player.off(["adseeked","seeked","adend"],n),e.setState(t)})},a.callSubsCapsButton_=function(e){var t=this.player.getChild("controlBar"),n=t&&t.getChild("subsCapsButton");if(n)return e?n[e]():n},a.toggleListeners_=function(e){var n=this.player,i=t.getTech("Html5").Events.concat(["adend","adended","adstart"]);this[e](n,i,this.logEvent_),this[e](n,"adend",this.onAdEnd_),this[e](n,"adstart",this.onAdStart_),this[e](n,"bcov-ssai-click-through",this.onBcovSsaiClickThrough_),this[e](n,"ended",this.onEnded_),this[e](n,"error",this.onError_),this[e](n,["seeked","adseeked"],this.onSeeked_),this[e](n,["pause","adpause"],this.onPause_),this[e](n,["play","adplay"],this.onPlay_),this[e](n,"loadedmetadata",this.onLoadedMetadata_),this[e](n,["timeupdate","adtimeupdate"],this.onTimeupdate_),this[e](n,["volumechange","advolumechange"],this.onVolumeChange_)},a.toggleProgressControl_=function(){var e=this.player.getChild("controlBar"),t=e&&e.getChild("progressControl");t&&"function"!=typeof t.enabled||(t.enabled()?t.disable():t.enable())},a.logEvent_=function(e){this.log_('saw "'+e.type+'"')},a.onLoadedMetadata_=function(){this.playedAdRolls_.length=0},a.onAdEnd_=function(e){var t=this,n=this.currentTimelineState(),i=n.linearAdRoll&&n.linearAdRoll.isPostRoll();this.player.setTimeout(function(){t.toggleProgressControl_(),i||(t.fire_("play"),t.fire_("playing")),t.callSubsCapsButton_("update"),t.overlayManager_.delegate("hide"),t.seekAfterAd_&&t.doSeekAfterAd_()},1)},a.onAdStart_=function(e){var t=this.player;this.fire_("ads-pod-started"),this.toggleProgressControl_(),t.setTimeout(function(){t.paused()&&t.play()},1),this.lastMuted_=t.muted(),this.lastVolume_=t.volume(),this.callSubsCapsButton_("hide"),this.overlayManager_.delegate("show")},a.onBcovSsaiClickThrough_=function(e){var t=e.linearAd||this.currentLinearAd_;if(this.log_("click-thru",{linearAd:t}),t){var i=t.clickThroughUrl();this.sendBeacon_("click"),i&&(this.player.pause(),this.fire_("ads-click"),n.open(i,"_blank"))}},a.onDispose_=function(e){var t=this;this.playedAdRolls_.length=0,this.disable(),this.player.el().className.split(/\s+/).forEach(function(e){e.substr(0,8)===h()&&t.player.removeClass(e)})},a.fakeEnded=function(e){if("boolean"!=typeof e)return this.fakeEnded_;this.fakeEnded_=e},a.onEnded_=function(e){var t=this.player,n=this.timeline_,i=n&&n.last();if(n.linearAdRolls().length&&this.fire_("ads-allpods-completed"),this.playedAdRolls_=[],this.currentLinearAd_=null,i&&i.isPostRoll()&&this.fakeEnded()){var r=t.getChild("posterImage");this.timeline_.hasEnded(!0),r&&(r.show(),r.addClass("vjs-displayed")),this.updateDuration_(),this.updateCurrentTime_()}},a.onError_=function(){this.overlayManager_.disable()},a.onPause_=function(e){this.player.ads.isInAdMode()&&(this.fire_("ads-pause"),this.sendBeacon_("pause"))},a.onPlay_=function(e){this.player.ads.isInAdMode()?(this.fire_("ads-play"),this.sendBeacon_("resume")):this.evaluateTimelineState_(),this.resetTimelineEnded_()},a.onStateChanged_=function(e){var t=this.player;Object.keys(Xe).forEach(function(n){var i=e&&e.changes&&e.changes[n];if(i){var r=Xe[n].map(h),a=r[0],o=r[1];i.to?(t.removeClass(a),t.addClass(o)):(t.removeClass(o),t.addClass(a))}})},a.startLinearAdMode_=function(e){var t=this.player;this.log_("starting linear ad mode"),t.ads.startLinearAdMode(),e&&-1===this.playedAdRolls_.indexOf(e)&&this.playedAdRolls_.push(e)},a.startLinearAd_=function(e,t){var n=this.player;e!==this.currentLinearAd_&&(this.log_("starting linear ad",{linearAd:e}),this.currentLinearAdTracker_=new N(e,{enabled:Boolean(this.options_.trackingBeacons)}),this.currentLinearAd_=e,n.ads.ad={id:e.id(),index:t.indexOf(e),duration:e.duration()},this.fire_("ads-ad-started"),this.sendBeacon_("impression"),this.sendBeacon_("start"),this.sendBeacon_("creativeView"),this.log_("set linear ad"))},a.continueLinearAd_=function(e){if(this.currentLinearAd_){for(var t=e.absoluteTime,n=["ads-first-quartile","ads-midpoint","ads-third-quartile"],i=["firstQuartile","midpoint","thirdQuartile"],r=this.currentLinearAd_.trackingEvents(),a=0;a<i.length;a++){var o=i[a],s=i[a+1],d=r[o].time,l=s?r[s].time:1/0;if(t>=d&&t<l){this.sendBeacon_(o),1===this.currentLinearAdTracker_.trackedCount(o)&&this.fire_(n[a]);break}}this.overlayManager_.delegate("update",e)}},a.endLinearAd_=function(){var e=this.player;this.currentLinearAd_&&(this.log_("ending linear ad",{linearAd:this.currentLinearAd_}),this.sendBeacon_("complete"),this.fire_("ads-ad-ended"),e.ads.ad&&(e.ads.ad=null),this.currentLinearAd_=this.currentLinearAdTracker_=null)},a.endLinearAdMode_=function(e){var t=this.player;if(t.ads.isInAdMode()&&(this.log_("ending linear ad mode"),this.fire_("ads-pod-ended"),this.seekAfterAd_&&this.fire_("unstable"),t.ads.endLinearAdMode(),this.seekAfterAd_)){var n=this.absoluteTimelineState(this.player.tech(!0).currentTime()+1);e.linearAd&&!n.linearAd&&this.doSeekAfterAd_()}},a.shouldIgnoreTimeupdate_=function(){var e=this.player;return e.hasStarted()?e.paused()?"paused":e.scrubbing()?"scrubbing":e.seeking()?"seeking":"ads-ready?"===e.ads.state?'ads state is "ads-ready?"':e.usingPlugin("perSourceBehaviors")&&!e.perSourceBehaviors.isSrcStable()?"per-source-behaviors sees the source is unstable":void 0:"has not started"},a.evaluateTimelineState_=function(){var e=this.player.ads.isInAdMode(),t=this.currentLinearAd_,n=this.currentTimelineState(),i=n.linearAd,r=n.linearAdRoll,a=i!==t;a&&this.log_("linear ad changed",{previousLinearAd:t,linearAd:i}),this.updateDuration_(),this.updateMarkers_(),t&&a&&this.endLinearAd_(),!i&&e&&(this.endLinearAdMode_(n),this.log_("content mode resumed",{duration:this.contentDuration()})),i&&(a&&!e&&this.startLinearAdMode_(r),a?this.startLinearAd_(i,r):this.continueLinearAd_(n))},a.onTimeupdate_=function(e){var t=ze.now(),n=this.shouldIgnoreTimeupdate_();if(n)this.log_('ignoring "'+e.type+'" because '+n);else{this.evaluateTimelineState_();var i=ze.now()-t;i>6&&this.log_('processing "'+e.type+'" took '+i+"ms!")}},a.doSeekAfterAd_=function(){this.seekAfterAd_&&(this.log_("seeking to original time",{originalTime:this.seekAfterAd_.relativeTime}),this.seekInAbsoluteTime(this.seekAfterAd_.absoluteTime),this.seekAfterAd_=null)},a.resetTimelineEnded_=function(){var e=this.timeline_,t=this.player;if(e&&e.hasEnded()){var n=t.getChild("posterImage");n&&n.removeClass("vjs-displayed"),e.hasEnded(!1)}},a.updateDuration_=function(){var e=this.currentTimelineState(),t=this.player.getCache().duration;t&&e.relativeDuration===t||(t&&this.log_("updating duration cache",{from:t,to:e.relativeDuration}),this.player.duration(e.relativeDuration))},a.updateCurrentTime_=function(){var e=this,t=this.timeline_,n=this.player;t&&t.hasEnded()&&n.setTimeout(function(){e.fire_("timeupdate")},100)},a.updateMarkers_=function(){if(this.adMarkers_.length){var e="show";this.currentTimelineState().linearAd&&(e="hide"),this.adMarkers_.forEach(function(t){return t[e]()})}},a.onSeeked_=function(e){this.updateDuration_()},a.onVolumeChange_=function(e){if(this.player.ads.isInAdMode()){var t,n=this.player.muted(),i=this.player.volume(),r=n!==this.lastMuted_,a=i!==this.lastVolume_;a&&0===i||r&&n?t="mute":(a&&0===this.lastVolume_||r&&!n)&&(t="unmute"),t&&(this.fire_("ads-"+t),this.sendBeacon_(t)),this.lastMuted_=n,this.lastVolume_=i}},i}(t.getPlugin("plugin"));return $e.defaultState={enabled:!1,waiting:!1,adSkipPreventer:!1,adSeekPreventer:!1},$e.MIME_TYPE=$,$e.VERSION="1.4.3",function(e){if(t.getPlugin("ssai"))return!1;var n,i,r,a,o=t.getPlugin("ads");n=o.VERSION,r=ne(n),(!(a=i?ne(i):ie)||!r||r[0]!==a[0]||r[1]<a[1]||!(r[1]>a[1]||r[2]>=a[2]))&&t.log.error('The SSAI plugin depends on contrib-ads version "'+ie+'", but it saw version "'+o.VERSION+'". This is not a compatible configuration. The SSAI plugin will attempt to continue initializing, but this problem should be addressed. If you are using ad failover, please select compatible versions of the SSAI and IMA plugins.'),t.usingSsaiMiddleware_||(t.use($,J),t.use("*",te),t.usingSsaiMiddleware_=!0),t.registerPlugin("ssai",e)}($e),$e});
